---
title: "Building an Affordable MVP Batting Team."
output:
  html_document:
    code_folding: hide
    df_print: paged
    toc: yes
    toc_float: yes
    number_sections: no
    pdf_document: default
  word_document:
    toc: yes
---


Buried in this data set exists a roster of 40 batters that earns a **below average salary** and gives an **above average performance**.

## Import
Source: [Major League Baseball data from 1985 to 2016](https://docs.google.com/spreadsheets/d/1oF1G3jPHcn9lGivHNJk82X7Azk4_Wy0l/edit?usp=share_link&ouid=117939447554917976953&rtpof=true&sd=true)

```{r}
mlb=readxl::read_excel('MLB_1985-2016.xlsx')
dim(mlb)
```
There are 28,293 rows and 28 columns in this data set.

## Clean

```{r}
mlb_cleaned = mlb |> 
  drop_na() |> 
  dplyr::filter(!duplicated(`Player Name`)) |> 
  rename(Salary = salary, Runs = R)

sum(is.na(mlb_cleaned))
dim(mlb_cleaned)
```

Removed NA and duplicate values, and renamed two columns for labeling clarity. Now the data set has 4,931 rows. Let's look at batters earning **below average salary** AND giving **above average performance**.

```{r,message=F}
summary(mlb_cleaned$Salary)
```
Salaries below \$410,000 will be the cut-off because \$312,400 was too low (zero players existed in this salary range). Next, we'll look at `Runs` - the number of times a batter scores a run and **Runs Batted In (`RBI`)** - a statistic that measures how many runs a batter has driven in.

```{r}
summary(mlb_cleaned$RBI)
summary(mlb_cleaned$Runs)
```

`HR` - Home Runs could have been used as a metric, but they aren't as common and reliable as `RBI` or `Runs`. Now, we'll use `RBI` > 13 and `Runs` > 14 as the cut-off for above average metrics. Also, only batters from 2006 to 2016 will be considered because they would have more relevance than someone from previous seasons. **These metrics, along with `Salary` < $410,000, will make up the Most Valuable Player (MVP) roster.**

## Explore
What is the relationship between `RBI` and `Runs` within the MVP roster?

```{r}
mlb_mvp = mlb_cleaned |> 
dplyr::filter(Season %in% c('2016':'2006') & RBI > 13 & Runs > 14 & Salary < 410000) |> 
select(`Player Name`,Runs,RBI,Salary,Team, everything()) |> arrange(desc(Runs)) |> 
arrange(desc(RBI))
```

```{r,message=F,warning=F}
library(gridExtra)

shapiro.test(mlb_mvp$RBI)
shapiro.test(mlb_mvp$Runs)

mdens1=mlb_mvp %>% 
  ggplot(aes(RBI))+
  geom_histogram(aes(y=..density..))+
  geom_density(col='red',lwd=1)

mdens2=mlb_mvp %>% 
  ggplot(aes(Runs))+
  geom_histogram(aes(y=..density..))+
  geom_density(col='green',lwd=1)

grid.arrange(mdens1,mdens2)

cor.test(mlb_mvp$Runs,mlb_mvp$RBI,method='spearman')
```

With a **correlation value of 0.8263**, there is a strong positive monotonic (not necessarily linear) relationship between `RBI` and `Runs`.

```{r,message=F,warning=F}

mlb_mvp |> 
  ggplot(aes(x= Runs,y = RBI))+
  geom_smooth(method='auto')+
  geom_point(size=2)+
  labs(title='RBI by Runs and less than $410,000',x='Runs',y='Runs Batted In',caption = 'Source: Major League Baseball data from 1985 to 2016')+
  theme_minimal()+
  theme(legend.position = 'none')+
  theme(plot.title = element_text(hjust = .5))+
  annotate('text',x=111,y=125,label='Carlos Gonzalez',size=3,col='darkred')+
  annotate('text',x=104,y=157,label='Ryan Howard',size=3,col='darkred')+
  annotate('text',x=35,y=120,label="rs = 0.8263",col='blue')

```

Here are the batters with above average `RBI` and `Runs` with below average `Salary`. Additionally, the plot shows two batters, Ryan Howard and Carlos Gonzalez, colored in teal and shaped as triangles scoring above 100 in both `RBI` and `Runs`. In other words, they have above averages within the already above average MVP roster.

## Recommendation

```{r}
mlb_mvp %>% 
head(40)
```
Ryan Howard scores triple digits in `RBI` and `Runs` for costing a mere $355,000. **I recommend prioritizing the recruitment of Howard, and future batters using these metrics, first before proceeding with the rest of the roster.** That said, here are the top 40 batters that cost below the average `Salary` (< $410,000) and score above average in `RBI` (> 13) and `Runs` (> 14).

## Export
[Top 40 MVP Roster](https://docs.google.com/spreadsheets/d/1sLiAE4Dh-8dvCCGJJNes2JgdH6rxLO0E/edit?usp=sharing&ouid=117939447554917976953&rtpof=true&sd=true).

```{r}
sessionInfo()
```
